# Generated by Django 4.0.7 on 2022-09-10 23:18

from django.db import migrations, models
import json.decoder
import json.encoder


def migrate_stderr_to_json(apps, schema_editor):
    Submit = apps.get_model('submit', 'Submit')
    for obj in Submit.objects.all():
        if obj.stderr is not None:
            obj.stderr = json.dumps({'stderr': obj.stderr})
        obj.save()


class Migration(migrations.Migration):

    dependencies = [
        ('submit', '0004_submit_last_case_idx'),
    ]

    operations = [
        migrations.AlterField(
            model_name='submit',
            name='result',
            field=models.CharField(choices=[('AC', '✅ 맞았습니다!!'), ('WA', '❌ 틀렸습니다'), ('CP', '✅ 실행 완료'), ('TLE', '⏳ 시간 초과'), ('MLE', '💣 메모리 초과'), ('OLE', '📝 출력 초과'), ('RTE', '💥 오류 발생'), ('PRE', '🚩 준비 중'), ('ON', '🔁 채점 중'), ('IE', '⚠️내부 오류')], default='PRE', max_length=3),
        ),
        migrations.RunPython(migrate_stderr_to_json),
        migrations.AlterField(
            model_name='submit',
            name='stderr',
            field=models.JSONField(decoder=json.decoder.JSONDecoder, encoder=json.encoder.JSONEncoder, null=True),
        ),
    ]
